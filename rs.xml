<Module>
  <ModulePrefs title="Resources" />

  <Content type="html">
    <![CDATA[
<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, user-scalable=no"
  />

  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/z-f3-f1/1@main/style.css"
  />

  <!-- GameMonetize SDK Integration -->
  <script type="text/javascript">
    window.SDK_OPTIONS = {
      gameId: "jp112o3o4hzgrnc7zaewjkrfk282pul8",
      onEvent: function (a) {
        switch (a.name) {
          case "SDK_GAME_PAUSE":
            console.log("Oyun duraklatıldı, ses kapatılıyor...");
            if (typeof myGameInstance !== "undefined" && myGameInstance) {
              myGameInstance.SendMessage("AudioManager", "MuteAudio");
            }
            break;

          case "SDK_GAME_START":
            console.log("Reklam bitti, oyun devam ediyor...");
            if (typeof myGameInstance !== "undefined" && myGameInstance) {
              myGameInstance.SendMessage("AudioManager", "UnmuteAudio");
            }
            break;

          case "SDK_READY":
            console.log("SDK hazır.");
            break;
        }
      }
    };

    (function (a, b, c) {
      var d = a.getElementsByTagName(b)[0];
      if (!a.getElementById(c)) {
        a = a.createElement(b);
        a.id = c;
        a.src = "https://cdn.jsdelivr.net/gh/testamalame/sef@main/sedk.js";
        d.parentNode.insertBefore(a, d);
      }
    })(document, "script", "gamemonetize-sdk");
  </script>

  <style>
    canvas:focus {
      outline: none;
    }

    html,
    body {
      padding: 0;
      margin: 0;
      overflow: hidden;
      height: 100%;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }
  </style>
</head>

<body class="dark">
  <div id="unity-container" class="unity-desktop">
    <canvas id="unity-canvas" tabindex="-1"></canvas>
  </div>

  <div id="loading-cover" style="display: none;">
    <div id="unity-loading-bar">
      <div id="unity-progress-bar-empty" style="display: none;">
        <div id="unity-progress-bar-full"></div>
      </div>
      <div class="spinner"></div>
    </div>
  </div>

  <script>
    const buildUrl =
      "https://cdn.jsdelivr.net/gh/z-f3-f1/1@main/Build";
    const loaderUrl = buildUrl + "/yandexBrotli.loader.js";

    const config = {
      dataUrl: buildUrl + "/yandexBrotli.data.br",
      frameworkUrl: buildUrl + "/yandexBrotli.framewor.js",
      streamingAssetsUrl: "StreamingAssets",
      companyName: "Brain massage",
      productName: "Supercar Battle Royale",
      productVersion: "0.0.197"
    };

    function loadAndMergeFiles(files, callback) {
      const mergedBlob = [];

      function loadNextFile(index) {
        if (index >= files.length) {
          callback(new Blob(mergedBlob));
          return;
        }

        fetch(buildUrl + "/" + files[index])
          .then((r) => r.arrayBuffer())
          .then((data) => {
            mergedBlob.push(new Uint8Array(data));
            loadNextFile(index + 1);
          })
          .catch((e) =>
            console.error("Dosya yüklenemedi:", files[index], e)
          );
      }

      loadNextFile(0);
    }

    const wasmFiles = [
      "yandexBrotli.wasm.br.part1",
      "yandexBrotli.wasm.br.part2"
    ];

    const container = document.querySelector("#unity-container");
    const canvas = document.querySelector("#unity-canvas");
    const loadingCover = document.querySelector("#loading-cover");
    const progressBarEmpty = document.querySelector("#unity-progress-bar-empty");
    const progressBarFull = document.querySelector("#unity-progress-bar-full");
    const spinner = document.querySelector(".spinner");

    if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
      container.className = "unity-mobile";
    }

    let myGameInstance = null;
    let isAdShown = false;

    function showAdOnClick() {
      if (!isAdShown && typeof sdk !== "undefined" && sdk.showBanner) {
        sdk.showBanner();
        isAdShown = true;
      }
    }

    loadAndMergeFiles(wasmFiles, function (mergedWasmBlob) {
      config.codeUrl = URL.createObjectURL(mergedWasmBlob);

      const script = document.createElement("script");
      script.src = loaderUrl;

      script.onload = () => {
        createUnityInstance(canvas, config, (progress) => {
          progressBarFull.style.width = `${100 * progress}%`;
        })
          .then((unityInstance) => {
            myGameInstance = unityInstance;
            loadingCover.style.display = "none";
            canvas.addEventListener("pointerdown", showAdOnClick);
            canvas.addEventListener("touchstart", showAdOnClick);
          })
          .catch(alert);
      };

      document.body.appendChild(script);
    });

    loadingCover.style.background =
      "url('https://cdn.jsdelivr.net/gh/eteppe555/1@main/Images/logo.png') center / cover";
    loadingCover.style.display = "";

    document.addEventListener("contextmenu", (e) => e.preventDefault());
  </script>

  <!-- GOOGLE AD -->
  <style>
    #ad-container {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: min(728px, calc(100% - 20px));
      height: 90px;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      z-index: 99999;
      overflow: hidden;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.45);
    }

    #ad-container.hidden {
      transform: translate(-50%, -100%);
    }

    #ad-iframe {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 745px;
      height: 90px;
      border: 0;
    }

    #close-ad {
      position: absolute;
      top: 6px;
      right: 8px;
      background: #ff4d4d;
      color: #fff;
      border: none;
      padding: 5px 9px;
      font-size: 13px;
      opacity: 0.72;
      cursor: not-allowed;
    }

    #close-ad.enabled {
      cursor: pointer;
      opacity: 1;
    }

    #close-ad::before {
      content: "↑";
      margin-right: 4px;
    }
  </style>

  <div id="ad-container" aria-hidden="true">
    <iframe
      id="ad-iframe"
      src="https://script.google.com/macros/s/AKfycbzA6GNdpfUShkCh6apD0D21YAUf7A5d3Guhq2PayqLbk_5XG_wQhy0bdYzKJWLhzgMVMQ/exec"
      scrolling="no"
    ></iframe>

    <button id="close-ad" disabled>Close (12)</button>
  </div>

  <script>
    (function () {
      const showDelay = 2000;
      const countdownStart = 12;
      const reappearDelay = 25000;

      const adContainer = document.getElementById("ad-container");
      const closeBtn = document.getElementById("close-ad");

      function showAd() {
        adContainer.style.display = "block";
        adContainer.classList.remove("hidden");

        let timeLeft = countdownStart;
        closeBtn.textContent = `Close (${timeLeft})`;
        closeBtn.disabled = true;

        const t = setInterval(() => {
          timeLeft--;
          if (timeLeft > 0) {
            closeBtn.textContent = `Close (${timeLeft})`;
          } else {
            clearInterval(t);
            closeBtn.disabled = false;
            closeBtn.classList.add("enabled");
            closeBtn.textContent = "Close ↑";
          }
        }, 1000);
      }

      setTimeout(showAd, showDelay);

      closeBtn.addEventListener("click", () => {
        if (closeBtn.disabled) return;
        adContainer.classList.add("hidden");
        setTimeout(showAd, reappearDelay);
      });
    })();
  </script>
</body>
</html>
    ]]>
  </Content>
</Module>
